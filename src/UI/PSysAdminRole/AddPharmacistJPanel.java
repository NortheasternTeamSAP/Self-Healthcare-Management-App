/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package UI.PSysAdminRole;

import DataStore.GlobalUserDirectory;
import EcoSystem.EcoSystem;
import Personnel.Address;
import Personnel.PersonDetails;
import Personnel.UserAccount;
import Pharmacy.Pharmacist;
import java.awt.CardLayout;
import java.awt.Component;
import java.time.Instant;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.Date;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

/**
 *
 * @author sravy
 */
public class AddPharmacistJPanel extends javax.swing.JPanel {
    private JPanel workArea;
    private EcoSystem ecoSys;
    /**
     * Creates new form AddPharmacistJPanel
     */
    public AddPharmacistJPanel(JPanel workArea,EcoSystem ecoSys) {
        this.ecoSys = ecoSys;
        this.workArea = workArea;
        initComponents();
        populatecmbPGender();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnBack = new javax.swing.JButton();
        btnSave = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        lblName = new javax.swing.JLabel();
        txtAddPName = new javax.swing.JTextField();
        lblDOB = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        lblBuildingNo = new javax.swing.JLabel();
        txtAddPBuildingNo = new javax.swing.JTextField();
        lblDOB1 = new javax.swing.JLabel();
        txtAddPSt = new javax.swing.JTextField();
        lblName2 = new javax.swing.JLabel();
        txtAddPCity = new javax.swing.JTextField();
        lblZIP = new javax.swing.JLabel();
        txtAddPZIP = new javax.swing.JTextField();
        lblName3 = new javax.swing.JLabel();
        txtAddPCountry = new javax.swing.JTextField();
        lblZIP1 = new javax.swing.JLabel();
        txtAddPPhNo = new javax.swing.JTextField();
        lblZIP2 = new javax.swing.JLabel();
        txtAddPState = new javax.swing.JTextField();
        lblName4 = new javax.swing.JLabel();
        lblZIP3 = new javax.swing.JLabel();
        txtPUsername = new javax.swing.JTextField();
        txtPPassword = new javax.swing.JPasswordField();
        cmbPGender = new javax.swing.JComboBox<>();
        jDateChooserPharmacist = new com.toedter.calendar.JDateChooser();

        btnBack.setText("Back");
        btnBack.setToolTipText("Back");
        btnBack.setContentAreaFilled(false);
        btnBack.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBackActionPerformed(evt);
            }
        });

        btnSave.setFont(new java.awt.Font("Segoe UI", 0, 12)); // NOI18N
        btnSave.setText("Save");
        btnSave.setContentAreaFilled(false);
        btnSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel1.setText("Create Pharmacist Details");

        lblName.setText("Name:");

        lblDOB.setText("DOB:");

        jLabel2.setText("Gender:");

        lblBuildingNo.setText("Building No:");

        txtAddPBuildingNo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAddPBuildingNoActionPerformed(evt);
            }
        });

        lblDOB1.setText("Street");

        lblName2.setText("City");

        lblZIP.setText("ZIP");

        lblName3.setText("Country");

        lblZIP1.setText("Phone Number:");

        lblZIP2.setText("State");

        lblName4.setText("Username");

        lblZIP3.setText("Password");

        cmbPGender.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cmbPGender.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbPGenderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(457, Short.MAX_VALUE)
                .addComponent(btnSave)
                .addGap(266, 266, 266))
            .addGroup(layout.createSequentialGroup()
                .addGap(61, 61, 61)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addGap(46, 46, 46)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cmbPGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jDateChooserPharmacist, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addComponent(btnBack, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(101, 101, 101)
                        .addComponent(lblName4)
                        .addGap(64, 64, 64)
                        .addComponent(txtPUsername, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(70, 70, 70)
                        .addComponent(lblZIP3)
                        .addGap(76, 76, 76)
                        .addComponent(txtPPassword, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(43, 351, Short.MAX_VALUE))
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addContainerGap(38, Short.MAX_VALUE)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblName)
                            .addGap(43, 43, 43)
                            .addComponent(txtAddPName, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblDOB)
                            .addGap(251, 251, 251))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblBuildingNo)
                            .addGap(13, 13, 13)
                            .addComponent(txtAddPBuildingNo, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblDOB1)
                            .addGap(48, 48, 48)
                            .addComponent(txtAddPSt, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblName2)
                            .addGap(60, 60, 60)
                            .addComponent(txtAddPCity, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblZIP)
                            .addGap(62, 62, 62)
                            .addComponent(txtAddPZIP, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblZIP2)
                            .addGap(52, 52, 52)
                            .addComponent(txtAddPState, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblName3)
                            .addGap(38, 38, 38)
                            .addComponent(txtAddPCountry, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                            .addComponent(lblZIP1)
                            .addGap(3, 3, 3)
                            .addComponent(txtAddPPhNo, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGap(0, 446, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(49, 49, 49)
                .addComponent(btnBack, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(190, 190, 190)
                        .addComponent(jDateChooserPharmacist, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(36, 36, 36)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(cmbPGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 421, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtPUsername, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblName4))
                        .addGap(36, 36, 36)
                        .addComponent(lblZIP3)
                        .addGap(45, 45, 45))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(txtPPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(25, 25, 25)))
                .addComponent(btnSave)
                .addGap(32, 32, 32))
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(1, 149, Short.MAX_VALUE)
                    .addComponent(jLabel1)
                    .addGap(32, 32, 32)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblName)
                        .addComponent(txtAddPName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(32, 32, 32)
                    .addComponent(lblDOB)
                    .addGap(104, 104, 104)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblBuildingNo)
                        .addComponent(txtAddPBuildingNo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(32, 32, 32)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblDOB1)
                        .addComponent(txtAddPSt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(22, 22, 22)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblName2)
                        .addComponent(txtAddPCity, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(32, 32, 32)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblZIP)
                        .addComponent(txtAddPZIP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(22, 22, 22)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblZIP2)
                        .addComponent(txtAddPState, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(22, 22, 22)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(lblName3)
                        .addComponent(txtAddPCountry, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(32, 32, 32)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                            .addGap(10, 10, 10)
                            .addComponent(lblZIP1))
                        .addComponent(txtAddPPhNo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGap(0, 217, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void btnBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBackActionPerformed
        workArea.remove(this);
        Component[] compArray = workArea.getComponents();
        Component component = compArray[compArray.length -1];
        CardLayout layout2 = (CardLayout) workArea.getLayout();
        layout2.previous(workArea);

    }//GEN-LAST:event_btnBackActionPerformed

    private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed
        // TODO add your handling code here:
        Date dob = jDateChooserPharmacist.getDate();
        
       LocalDate localDate = Instant.ofEpochMilli(dob.getTime())
      .atZone(ZoneId.systemDefault())
      .toLocalDate();
        if( txtAddPName.getText().isEmpty() ||
            (dob.toString().isEmpty()) ||  //later add for rbtns
            txtAddPBuildingNo.getText().isEmpty() ||
            txtAddPSt.getText().isEmpty() ||
            txtAddPCity.getText().isEmpty() ||
            txtAddPZIP.getText().isEmpty() ||
            txtAddPState.getText().isEmpty() ||
            txtAddPCountry.getText().isEmpty() ||
            txtAddPPhNo.getText().isEmpty() ||
            txtPPassword.getPassword().toString().isEmpty() ||
            txtPUsername.getText().isEmpty()) {
            JOptionPane.showMessageDialog(null, "Fields cannot be left empty");
            return;
        }

        boolean flag ;

        String phoneNumber = txtAddPPhNo.getText();

        if(phoneNumber.length() != 10) {
            JOptionPane.showMessageDialog(null, "PhoneNumber must be of 10 digits");
            return;
        }

        flag = phoneNumber.matches("^[0-9]+$");
        if(!flag) {
            JOptionPane.showMessageDialog(null, "Phone Number must contain only digits ");
            return;
        }

        Address address = new Address(
                txtAddPSt.getText(),
                txtAddPBuildingNo.getText(),
                txtAddPCity.getText(),
                txtAddPZIP.getText(),
                txtAddPState.getText(),
                txtAddPCountry.getText()
        );
        
        PersonDetails.Gender gender = PersonDetails.Gender.MALE;
        if ("Male".equals(cmbPGender.getSelectedItem().toString())){
            gender = PersonDetails.Gender.MALE;
        } else if ("Female".equals(cmbPGender.getSelectedItem().toString())){
            gender = PersonDetails.Gender.FEMALE;
        } else {
            gender = PersonDetails.Gender.OTHER;
        }
        Pharmacist pharmacist = new Pharmacist(
            txtAddPName.getText(),
            localDate,
            gender,
            address,
            txtAddPPhNo.getText(),
            null,
            new UserAccount(txtPUsername.getText(), txtPPassword.getPassword().toString()),
            -1);
        ecoSys.globalUserDirectory.createNewUser(pharmacist);
        
    }//GEN-LAST:event_btnSaveActionPerformed

    private void cmbPGenderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbPGenderActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cmbPGenderActionPerformed

    private void txtAddPBuildingNoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAddPBuildingNoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtAddPBuildingNoActionPerformed

    private void populatecmbPGender(){
 
        cmbPGender.addItem("Male");
        cmbPGender.addItem("Female");
        cmbPGender.addItem("Other");
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnBack;
    private javax.swing.JButton btnSave;
    private javax.swing.JComboBox<String> cmbPGender;
    private com.toedter.calendar.JDateChooser jDateChooserPharmacist;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel lblBuildingNo;
    private javax.swing.JLabel lblDOB;
    private javax.swing.JLabel lblDOB1;
    private javax.swing.JLabel lblName;
    private javax.swing.JLabel lblName2;
    private javax.swing.JLabel lblName3;
    private javax.swing.JLabel lblName4;
    private javax.swing.JLabel lblZIP;
    private javax.swing.JLabel lblZIP1;
    private javax.swing.JLabel lblZIP2;
    private javax.swing.JLabel lblZIP3;
    private javax.swing.JTextField txtAddPBuildingNo;
    private javax.swing.JTextField txtAddPCity;
    private javax.swing.JTextField txtAddPCountry;
    private javax.swing.JTextField txtAddPName;
    private javax.swing.JTextField txtAddPPhNo;
    private javax.swing.JTextField txtAddPSt;
    private javax.swing.JTextField txtAddPState;
    private javax.swing.JTextField txtAddPZIP;
    private javax.swing.JPasswordField txtPPassword;
    private javax.swing.JTextField txtPUsername;
    // End of variables declaration//GEN-END:variables
}
